#!/bin/sh

#
# Recorder for spontaneous activity
# Author: Daniele Linaro, July 2012
#

print_help()
{
    echo
    echo "Recorder of spontaneous activity"
    echo
    echo "Usage : `basename $0` [options <value>]"
    echo
    echo "where options are:"
    echo
    echo "   -h   display this help message and exit"
    echo "   -d   duration of the recording in seconds (default 60)"
    echo
}

duration=60
while getopts ":d:h" opt ; do
    case $opt in
	d)
	    duration=$OPTARG
	    ;;
	h)
	    print_help
	    exit 0
	    ;;
	\?)
	    echo "Invalid option: -$OPTARG."
	    echo "Type `basename $0` -h for help."
	    exit 1
	    ;;
    esac
done

if [ -z "${CONFIGURATIONS_PATH:-}" ] ; then
    origconfigfile=$HOME/configurations/spontaneous.xml
else
    origconfigfile=$CONFIGURATIONS_PATH/spontaneous.xml
fi

configfile=/tmp/spontaneous.xml

sed -e 's#<tend>0</tend>#<tend>'$duration'</tend>#' $origconfigfile > $configfile
lcg -c $configfile
